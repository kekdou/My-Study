### 文件查找与搜索

**find：在文件系统中查找文件**

`find [查找路径] [匹配条件] [执行动作]`  

查找路径：
- `.`：表示当前目录，最常用的目录
- `/`：根目录

```shell
#在当前目录开始查找test.py
find . -name "test.py"
``` 

匹配条件： 
- `-name "文件名"`：按文件名精确匹配
- `-iname "文件名"`：不区分大小写地按文件名匹配
- `-type [类型]`：指定要查找的文件类型
  - `f`：普通文件
  - `d`：目录
  - `l`：符号链接

```shell
#查找名为my_app的目录
find . -type d -name "my_app"
```

- `-size [大小]`：根据文件大小查找
  - `+`：大于
  - `-`：小于
  - `c`：字节
  - `k`：KB
  - `M`：MB
  - `G`：GB

```shell
#查找大于1MB的文件
find . -size +1M
```

此外对于条件常用逻辑组合：
- `-a`：and
- `-o`：or
- `！`：not

```shell
#查找所有.txt或.md文件
find . -type f -name "*.txt" -o -name "*.md"
```

执行动作：
- `-print`：打印出匹配的文件的完整路径，这是默认行为
- `-delete`：删除找到的文件，比较危险，谨慎使用

```shell
#删除所有以.log 结尾的文件
find . -name "*.log" -delete
```

- `-exec [命令] {} \;`：对每一个找到的文件执行指定的命令
  - `{}`：代表find找到的文件
  - `\;`：表示命令结束  

但一般会使用 `-exec [命令] {} +`，这个指令与上一个类似，不过会将所有找到的文件作为参数一次性传递给命令，而不是逐个执行，因此对于一般命令会更加高效  

```shell
#找到所有.js文件并用ls -l查看详细信息
find . -name "*.js" -exec ls -l {} \;

#删除所有 .tmp 文件
find . -name "*.tmp" -exec rm {} +
```

*注意：对于文件与目录类型的参数，双引号不是必须的，当文件名含有空格或特殊字符时才必须加双引号*  

---

**grep：在文件中搜索文本内容**  

*`grep`通常使用于文本文件，不适合二进制文件*  

*在搜索特殊字符时注意用引号括起*  

`grep [选项] "匹配模式" [文件名]`  
- `-i`：忽略大小写
- `-n`：显示匹配内容的行号
- `-r`：递归搜索，在指定目录下所有文件中查找
- `-A [N]`：显示匹配行及其后面的N行
- `-B [N]`：显示匹配行及其前面的N行
- `-C [N]`：显示匹配行及其前后各N行

匹配模式支持普通文本和正则表达式，要搜索文件可以同时指定多个，也可以利用管道等  

```shell
#在当前目录下所有文件中查找包含main.js的文本
grep -r "main.js" .

#显示包含error的行以及其前后各3行
grep -C 3 "error" app.log

#匹配多种可能
grep a.c app.log
```

对于一些常用的正则表达式：
|char|meaning|example|explain|
|:---|:---|:---|:---|
|`.`|匹配任意单个字符|`a.c`|匹配abc、adc等|
|`*`|匹配其前一个字符的零个或多个|`go*gle`|匹配gogle、google、gooogle等|
|`^`|匹配行首|`^start`|匹配以 start 开头的行|
|`$`|匹配行尾|`end$`|匹配以 end 结尾的行|
|`[]`|匹配方括号内的任意一个字符|`[aeiou]`|匹配任意一个元音字母|
|`[^]`|匹配不在方括号内的任意一个字符|`[^aeiou]`|匹配任意一个非元音字母|
|`<`|匹配单词的开头|`<word`|匹配以 word 开头的单词|
|`>`|匹配单词的结尾|`word>`|匹配以 word 结尾的单词|

由此有常用的组合 `.*`贪婪匹配，表示任意多个任意字符  

---
